---

- name: ensure grafana dashboard dir exist
  become: yes
  file:
    path: "{{ dir_remote_grafana_dashboards }}"
    state: directory
    owner: root
    mode: 0755

- name: copy dashboards json
  become: yes
  copy:
    src: "{{ item }}"
    dest: "{{ dir_remote_grafana_dashboards }}"
    owner: root
    mode: 0644
  with_fileglob: "{{ dir_local_grafana_dashboards }}/*.json"

- name: find all remote dashboard json files
  find:
    path: "{{ dir_remote_grafana_dashboards }}"
  register: result_dashboards

- debug:
    var: "{{ item.path }}"
  with_items: "{{ result_dashboards.files }}"
  